!function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[i]={exports:{}};t[i][0].call(c.exports,function(e){var r=t[i][1][e];return o(r||e)},c,c.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r,o){n(this,e);var a=o.slidereveal;delete o.slidereveal;var i=this;this.name="panel",this.$=t,this.settings=t.extend({collapsable:!0,slidereveal:t.extend({autoEscape:!0,overlay:!1,position:"left",push:!1,speed:600,top:132,trigger:t(".panel .controls"),width:"50%",show:function(){i.show()},shown:function(){i.shown()},hide:function(){i.hide()}},a)},o),t(r).slideReveal(this.settings.slidereveal).slideReveal("show")}return o(e,[{key:"show",value:function(e,t){var r=this.$;TweenLite.to(r("#main-content"),.6,{className:"+=offset-5"}),r(e).find(".controls span").fadeIn(),r(e).find(".controls i").removeClass("principal-arrow-right").addClass("principal-cross"),TweenLite.to(r(e).find(".trigger"),.6,{right:0})}},{key:"shown",value:function(e,t){var r=this.$;r(e).find(".trigger").removeClass("bg-primary")}},{key:"hide",value:function(e,t){var r=this.$;TweenLite.to(r("#main-content"),.6,{className:"-=offset-5"}),r(e).find(".controls span").fadeOut(),r(e).find(".controls i").addClass("principal-arrow-right").removeClass("principal-cross"),TweenLite.to(r(e).find(".trigger"),.6,{right:-170}),r(e).find(".trigger").addClass("bg-primary")}}]),e}();r.default=a,t.exports=r.default},{}],2:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("./service-handler"),u=n(l),c=function(e){function t(e,r,n){o(this,t),n=e.extend({urls:{},rules:{},messages:{}},n);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));i.$=e;var s=i;return s.settings=n,s.$domElement=e(r),s.validation(),i}return i(t,e),s(t,[{key:"validation",value:function(){var e=this.$,t=this,r=t.$domElement.find("form").length?t.$domElement.find("form"):t.$domElement;t.valid=r.validate({normalizer:!0,errorElement:"p",errorClass:"is-invalid",validClass:"is-valid active",rules:t.settings.rules,messages:t.settings.messages,errorPlacement:function(e,t){t.closest(".form-group").append(e.addClass("text-danger pl-3"))},highlight:function(t,r,n){var o=e(t).closest(".input-group-icon");(o.length>0?o:e(t)).addClass(r).removeClass(n)},unhighlight:function(t,r,n){var o=e(t).closest(".input-group-icon");(o.length>0?o:e(t)).removeClass(r).addClass(n)}}),r.on("change","input, select, textarea",function(e){r.find("[type=submit]").prop("disabled",!r.valid())}),r.on("keyup","input, textarea",function(e){clearTimeout(t.st),t.st=setTimeout(function(){r.find("[type=submit]").prop("disabled",!r.valid())},300)})}},{key:"userUpdate",value:function(e,t){var r=(this.$,this),n=r.getToken(),o=r.ajax(e,t,{Authorization:n});o.fail(function(e,t,n){var o=e.responseJSON||{};switch(e.status){case 200:r.doneUserSelect();break;case 304:r.errorUserUpdate();break;case 404:r.errorUserEmail();break;case 500:default:r.error(e.status,o.error_description||t||"Error",null,e)}}).done(function(e,t,n){304==n.status?r.errorUserEmail():r.doneUserSelect()})}},{key:"errorUserUpdate",value:function(){var e=this;e.valid.showErrors({email:e.settings.messages.errorUserUpdate})}},{key:"errorUserEmail",value:function(){var e=this;e.valid.showErrors({email:e.settings.messages.errorUserEmail})}}]),t}(u.default);r.default=c,t.exports=r.default},{"./service-handler":3}],3:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r,o){n(this,e),o=t.extend({submit:!0,todo:null,todoUrl:null,urls:{}},o);var a=this;a.settings=o;var i=a.$domElement=t(r);if(a.settings.submit){var s=function(e){e.preventDefault();var r=t(e.target).serializeArray();r=r.concat(a.extraData),"function"==typeof a.settings.todo?a.settings.todo(a,r):"string"==typeof a.settings.todo&&a[a.settings.todo](a.url(a.settings.todoUrl),r)};i.find("form").length?i.on("submit","form",s):i.on("submit",s)}}return o(e,[{key:"login",value:function(e,t){var r=this,n=r.ajax(e,t);n.fail(function(e,t,n){var o=e.responseJSON||{};switch(e.status){case 400:case 401:r.errorLogin();break;case 429:var a=$($("#excessAttempts").html());r.error(e.status,a.filter(".title").html(),a.filter(".message").html());break;case 500:default:r.error(e.status,o.error_description||t||"Error",null)}}).done(function(e){r.doneLogin(e)})}},{key:"signout",value:function(){var e=this,t=e.getToken(),r=e.ajax(e.url("signout"),null,{Authorization:t});return r.always(function(){e.removeToken(),location.assign(baseUrl+"logout/")}),r}},{key:"userSelect",value:function(e){var t=this,r=t.getToken(),n=t.ajax(e,null,{Authorization:r});n.then(function(e,r,n){return"S"!=e.EsEmail?(n.responseJSON=e,$.Deferred().reject(n,"Error","Found")):void t.doneUserSelect(e)}).fail(function(e,r,n){var o=e.responseJSON||{};o.MailUnico?"S"==o.MailUnico?t.errorUserSelectFound():t.errorUserselectCallcenter():t.error(e.status,o.error_description||r||"Error",null,e.responseJSON)})}},{key:"contracts",value:function(){var e=this,t=e.getToken(),r=e.ajax(e.url("contracts"),null,{Authorization:t});return r.fail(function(t,r,n){var o=t.responseJSON||{};switch(t.status){case 401:e.errorToken();break;case 500:default:e.error(t.status,o.error_description||r||"Error")}}),r}},{key:"alias",value:function(e,t){var r=this,n=r.getToken(),o=r.ajax(r.url("alias"),t,{Authorization:n});return o.fail(function(e,t,n){var o=e.responseJSON||{};switch(e.status){case 401:r.errorToken();break;case 500:default:r.error(e.status,o.error_description||t||"Error")}}),o}},{key:"ajax",value:function(e,t,r){var n=this,o=$.ajax({url:e,data:t,method:"POST",dataType:"json",crossDomain:!0,headers:r,beforeSend:function(){n.loading()},complete:function(){n.loadingStop()}});return o}},{key:"doneLogin",value:function(e,t,r){this.setToken(e),this.userSelect(this.url("userSelect"))}},{key:"doneUserSelect",value:function(e,t,r){sessionStorage.setItem("user",JSON.stringify(e)),location.assign(baseUrl+"dashboard/")}},{key:"errorLogin",value:function(){this.$domElement.find("#error-msg").show();var e=this.$domElement.find(".input-group-icon,:not(.input-group-icon)>.form-control");e.addClass("is-invalid")}},{key:"errorUserSelectFound",value:function(){$(".modal").modal("hide"),$("#update-account").modal("show")}},{key:"errorUserselectCallcenter",value:function(){var e=$($("#callCenter").html());this.error(300,e.filter(".title").html(),e.filter(".message").html())}},{key:"errorToken",value:function(){this.removeToken(),location.assign(baseUrl+"login/")}},{key:"error",value:function(e,t,r,n){$(".modal").modal("hide"),$("#errorCatcher").find(".modal-title span").text(t||"Error"),$("#errorCatcher").find(".modal-body .message").html(r||"<p>CÃ³digo de error: "+e+"</p>"),n&&$("#errorCatcher").find(".modal-body .message").append($("<p></p>").jJsonViewer(n,{expanded:!0})),$("#errorCatcher").modal("show")}},{key:"setToken",value:function(e){e.date=Date.now(),sessionStorage.setItem("token",JSON.stringify(e))}},{key:"getToken",value:function(){var e=JSON.parse(sessionStorage.getItem("token"));return!!e&&e.token_type+" "+e.access_token}},{key:"removeToken",value:function(){sessionStorage.removeItem("token")}},{key:"url",value:function(e){return"base"==e?this.settings.urls.base:this.settings.urls.base+this.settings.urls[e]}},{key:"loading",value:function(e){$(e||this.$domElement).loading()}},{key:"loadingStop",value:function(e){$(e||this.$domElement).loading("stop")}},{key:"getExtraData",value:function(){return this.extraData}},{key:"setExtraData",value:function(e){this.extraData=e}}]),e}();r.default=a,t.exports=r.default},{}],4:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=e("../_modules/pug-components/panel/panel"),a=n(o),i=e("../_modules/pug-components/scripts/form-validation"),s=n(i);window.modules={Panel:a.default,FormValidation:s.default}},{"../_modules/pug-components/panel/panel":1,"../_modules/pug-components/scripts/form-validation":2}]},{},[4]);
//# sourceMappingURL=components.js.map
